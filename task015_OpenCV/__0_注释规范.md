# Doxygen注释规范
根据Doxygen官方文档，以下是一个比较全面的Doxygen标签列表，按照功能分类整理：

## 一、基本文档化命令

### 1.1 文件级文档
```doxygen
\file      文件描述
\brief     简要描述
\author    作者
\date      日期
\version   版本
\copyright 版权信息
\license   许可证信息
\def       宏定义文档化
\namespace 命名空间文档化
\package   包/模块文档化
```

```cpp
/**
 * @file     string_utils.cpp
 * @brief    字符串工具类实现文件，提供字符串拼接、分割、格式化等基础功能
 * @author   YinKang'an <ti.hu.guan.ding@qq.com>
 * @date     2026-01-29
 * @version  v2.1.1
 * @copyright Copyright (c) 2026 T-UP. All rights reserved.
 * @license   This project is licensed under the Apache License Version 2.0
 */

// 宏定义文档化示例
/**
 * @def     MAX_STR_LENGTH
 * @brief   字符串最大长度限制宏，防止内存溢出
 */
#define MAX_STR_LENGTH 1024

// 命名空间文档化示例
/**
 * @namespace StringUtils
 * @brief    封装所有字符串处理相关的函数和常量
 */
namespace StringUtils {

  // 包/模块文档化示例
  /**
   * @package   StringUtils::Formatter
   * @brief    字符串格式化子模块，负责各类数据转字符串、字符串拼接等操作
   */
  namespace Formatter {

    /**
     * @brief 将整数转换为指定长度的字符串
     * @param num 待转换的整数
     * @param length 目标字符串长度，不足补0
     * @return 格式化后的字符串
     */
    std::string intToStr(int num, int length = 0) {
      std::string str = std::to_string(num);
      if (length > str.size()) {
        str = std::string(length - str.size(), '0') + str;
      }
      return str;
    }
  } // namespace Formatter
} // namespace StringUtils

// 主函数测试
int main() {
    std::string str = StringUtils::Formatter::intToStr(123, 5);
    // 输出：00123
    std::cout << str << std::endl;
    return 0;
}

```

### 1.2 函数/方法文档
```doxygen
\brief      简要描述（也可用@brief）
\param      参数描述 [in]/[out]/[in,out]
\return     返回值描述
\retval     特定返回值描述
\exception  异常描述（同\throw）
\throws     抛出异常描述
\pre        前置条件
\post       后置条件
\sa         参考（另见）
\deprecated 已废弃标记
\tparam     模板参数
```
```cpp
/**
 * @brief 计算两个数的安全除法（非零检查）
 * 
 * @tparam T 数值类型（int/float/double）
 * @param dividend [in] 被除数
 * @param divisor [in] 除数，不能为0
 * @return T 除法结果
 * @retval 0 当除数为0时返回（实际会抛异常，仅作示例）
 * @exception std::runtime_error 除数为0时抛出异常
 * @throws std::invalid_argument 输入为负数且不允许时抛出
 * @pre divisor 不能为0，且dividend和divisor均非负
 * @post 返回值符号与被除数一致（除数为正）
 * @sa std::fabs 参考绝对值函数
 * @deprecated 该函数将在v1.1.0移除，建议使用safeDivideV2
 */
template <typename T>
T safeDivide(T dividend, T divisor) {
  // 前置条件检查
  if (divisor == 0) {
    throw std::runtime_error("Divisor cannot be zero!");
  }
  if (dividend < 0 || divisor < 0) {
    throw std::invalid_argument("Negative values are not allowed!");
  }
  return dividend / divisor;
}

```
### 1.3 类/结构体文档
```doxygen
\class     类文档
\struct    结构体文档
\union     联合体文档
\interface 接口文档
\extends   继承自（同\inherits）
\implements 实现接口
```

```cpp
/**
 * @class Shape
 * @brief 图形基类，定义图形的通用接口
 */
class Shape {
public:
  virtual double getArea() const = 0;
  virtual ~Shape() = default;
};

/**
 * @struct Point
 * @brief 二维坐标点结构体，存储x/y坐标
 */
struct Point {
  double x; // x轴坐标
  double y; // y轴坐标
};

/**
 * @union DataValue
 * @brief 通用数据值联合体，支持整型/浮点型/布尔型存储
 */
union DataValue {
  int intVal;
  double floatVal;
  bool boolVal;
};

/**
 * @interface Drawable
 * @brief 可绘制接口，定义绘制行为规范
 */
class Drawable {
public:
  virtual void draw() const = 0;
  virtual ~Drawable() = default;
};

/**
 * @class Circle
 * @brief 圆形类，实现面积计算和绘制功能
 * @extends Shape 继承自Shape基类
 * @implements Drawable 实现Drawable接口
 */
class Circle : public Shape, public Drawable {
private:
  Point center; // 圆心
  double radius; // 半径
public:
  Circle(Point c, double r) : center(c), radius(r) {}
  
  /**
   * @brief 计算圆形面积
   * @return 圆形面积
   */
  double getArea() const override {
    return 3.1415926 * radius * radius;
  }

  /**
   * @brief 绘制圆形
   */
  void draw() const override {
    // 绘制逻辑（示例）
  }
};

```

## 二、分组和模块化

### 2.1 分组命令
```doxygen
\defgroup    定义组
\ingroup     属于某组
\addtogroup  添加到组
\weakgroup   弱分组
\name        分组标题
\memberof    属于某成员
\relates     关联函数（非成员函数）
```

### 2.2 页面和章节
```doxygen
\page       创建页面
\mainpage   主页
\subpage    子页面
\section    章节
\subsection 子章节
\paragraph  段落
\subparagraph 子段落
\anchor     锚点
\ref        引用（链接）
```

## 三、格式化命令

### 3.1 文本样式
```doxygen
\b      粗体文本
\c      代码字体
\e      斜体
\em     强调（斜体）
\p      参数名格式
\a      参数引用
\code    代码块开始
\endcode 代码块结束
\verbatim 原始文本开始
\endverbatim 原始文本结束
```

### 3.2 列表
```doxygen
\li     列表项
\arg    参数列表项
\en     枚举列表
\par    带标题段落
\dot    生成Graphviz图
\enddot Graphviz图结束
\msc    生成MSC图
\endmsc MSC图结束
\startuml PlantUML开始
\enduml  PlantUML结束
```

## 四、特殊标记

### 4.1 状态标记
```doxygen
\todo    待办事项
\bug     已知bug
\warning 警告
\attention 注意
\note    备注
\invariant 不变式
\remarks  备注
\since    自某版本引入
```

### 4.2 可见性控制
```doxygen
\internal    内部使用
\private     私有（不推荐，使用访问修饰符）
\public      公开
\protected   保护
\privatepage 私有页面
\publicpage  公开页面
\protectedpage 保护页面
```

## 五、代码示例和引用

### 5.1 示例代码
```doxygen
\example   示例文件
\include   包含文件
\snippet   代码片段
\line      代码行号
\codeline 代码行
\includelineno 包含带行号的文件
\dontinclude 不包含在文档中
```

### 5.2 链接和引用
```doxygen
\see        参见
\link       HTML链接
\endlink    链接结束
\if        条件编译开始
\else      条件分支
\elseif    条件分支
\endif     条件结束
\cond      条件文档开始
\endcond   条件文档结束
```

## 六、特殊用途标签

### 6.1 属性文档
```doxygen
\property   属性
\var       变量
\fn        函数
\typedef   类型定义
\enum      枚举
```

### 6.2 自定义
```doxygen
\hideinitializer 隐藏初始化器
\showinitializer 显示初始化器
\nosubgrouping  禁止子分组
\details        详细描述
\short          简短描述（同\brief）
```

## 七、测试相关
```doxygen
\test       测试用例
\throwstest 测试抛出异常
\require    测试要求
\ensure     测试确保
\testcase   测试用例描述
```

## 八、对齐和格式
```doxygen
\par       新段落
\n         强制换行
\\         强制换行
\~         非换行空格
\--        连字符
\---       破折号
```

## 九、HTML/LaTeX专用
```doxygen
\htmlonly   仅HTML输出
\endhtmlonly
\latexonly  仅LaTeX输出
\endlatexonly
\manonly    仅man页输出
\endmanonly
\rtfonly    仅RTF输出
\endrtfonly
\xmlonly    仅XML输出
\endxmlonly
\docbookonly 仅DocBook输出
\enddocbookonly
```

## 十、图像和图表
```doxygen
\image     插入图像
\imagehtml 仅HTML图像
\imagelatex 仅LaTeX图像
\imagemd   仅Markdown图像
\dia       插入Dia图
\enddia
```

## 使用示例

```cpp
/**
 * \file example.h
 * \brief 示例文件说明
 * \author 作者名
 * \version 1.0
 * 
 * \details 详细描述信息
 * 
 * \defgroup ExampleGroup 示例分组
 * \{
 */

/**
 * \class ExampleClass
 * \brief 示例类说明
 * 
 * \details 类的详细描述
 * \ingroup ExampleGroup
 */
class ExampleClass {
public:
    /**
     * \brief 构造函数
     * \param value 初始值
     */
    ExampleClass(int value);
    
    /**
     * \brief 示例方法
     * \param input 输入参数
     * \return 计算结果
     * \exception std::invalid_argument 参数无效时抛出
     * \retval 0 成功
     * \retval -1 失败
     * \sa otherMethod()
     * \note 这是一个注意事项
     * \warning 这是一个警告
     * \todo 需要完善的功能
     */
    int exampleMethod(int input);
    
private:
    int m_value; ///< 成员变量说明
};

/** \} */ // end of ExampleGroup
```

## 重要提示

1. **别名支持**：大多数命令有两种形式：
   - 以`\`开头：`\brief`
   - 以`@`开头：`@brief`

2. **配置选项**：需要在Doxyfile中启用相应特性：
   ```
   EXTRACT_ALL = YES
   EXTRACT_PRIVATE = YES
   EXTRACT_STATIC = YES
   ```

3. **标记兼容性**：Doxygen支持Javadoc风格 (`/** ... */`)、Qt风格 (`/*! ... */`) 和其他多种风格。

4. **顺序建议**：一般按照`brief, param, return, see, note, warning`的顺序组织。

## **基本结构**

### **1. 函数注释格式**
```cpp
/** @brief 简要描述函数功能

@param 参数名 参数说明
@param [in] 参数名 输入参数说明    // 明确指定输入参数
@param [out] 参数名 输出参数说明   // 明确指定输出参数
@param [in,out] 参数名 输入输出参数说明
@return 返回值说明
@see 相关函数/类
@note 注意事项
@warning 警告信息
@deprecated 已弃用说明
*/
```

### **2. 实际示例解析**

```cpp
/** @brief Calculates the font-specific size to use to achieve a given height in pixels.

@param fontFace Font to use, see cv::HersheyFonts.
@param pixelHeight Pixel height to compute the fontScale for
@param thickness Thickness of lines used to render the text.See putText for details.
@return The fontSize to use for cv::putText

@see cv::putText
*/
CV_EXPORTS_W double getFontScaleFromHeight(const int fontFace,
                                           const int pixelHeight,
                                           const int thickness = 1);
```

## **常用标签说明**

| 标签 | 用途 | 示例 |
|------|------|------|
| `@brief` | 简要描述 | `@brief 计算文本大小` |
| `@param` | 参数说明 | `@param text 输入文本` |
| `@return` | 返回值说明 | `@return 包含宽度和高度的Size对象` |
| `@see` | 参考链接 | `@see putText, getTextSize` |
| `@note` | 注意事项 | `@note 此函数不是线程安全的` |
| `@warning` | 警告信息 | `@warning 输入图像必须是8位单通道` |
| `@code` `@endcode` | 代码示例 | 包含示例代码块 |
| `@deprecated` | 弃用说明 | `@deprecated 使用新函数代替` |
| `@overload` | 重载函数 | `@overload 函数的重载版本` |

## **完整示例模板**

```cpp
/** @brief 函数功能详细描述
 * 
 * 这里可以写更详细的描述，解释函数的用途、算法原理等。
 * 可以跨多行。
 * 
 * @param param1 第一个参数的详细说明
 * @param [in] param2 输入参数的说明
 * @param [out] param3 输出参数的说明，函数会修改此参数
 * @param [in,out] param4 既是输入也是输出的参数
 * @return 返回值的详细说明
 * 
 * @note 使用注意事项
 * @warning 重要的警告信息
 * @see relatedFunction, relatedClass
 * 
 * @code{.cpp}
 * // 使用示例
 * Mat image = imread("test.jpg");
 * Size textSize = getTextSize("Hello", FONT_HERSHEY_SIMPLEX, 1.0, 2, nullptr);
 * @endcode
 */
```

## **OpenCV特有的约定**

### **1. CV_EXPORTS 宏**
```cpp
CV_EXPORTS_W // 表示函数会导出到Python等绑定
CV_EXPORTS   // 普通导出
```

### **2. 输出参数标注**
```cpp
CV_OUT int* baseLine // 明确标注输出参数
```

### **3. 枚举引用**
```cpp
// 引用其他枚举或常量
@see cv::HersheyFonts  // 引用命名空间下的枚举
```

## **编写建议**

### **1. 保持一致性**
```cpp
// 不好的例子：参数说明不统一
/**
 * @param img 输入图像
 * @param thickness 线宽
 */

// 好的例子：格式统一
/**
 * @param image 输入图像，必须是8位单通道或3通道图像
 * @param thickness 线条厚度，大于0时表示线条粗细
 */
```

### **2. 提供完整示例**
```cpp
/** @brief 在图像上绘制文本
 * 
 * @code{.cpp}
 * // 基本用法
 * Mat image = Mat::zeros(200, 400, CV_8UC3);
 * putText(image, "OpenCV", Point(50, 100), 
 *         FONT_HERSHEY_SIMPLEX, 1.0, Scalar(0, 255, 0), 2);
 * @endcode
 */
```

### **3. 链接相关函数**
```cpp
/** @brief 获取文本显示大小
 * 
 * 此函数通常与putText配合使用，用于计算文本在图像中占据的空间。
 * 
 * @see cv::putText 绘制文本到图像
 * @see cv::getFontScaleFromHeight 根据高度获取字体缩放比例
 */
```

## **实践练习**

尝试为以下函数编写Doxygen注释：

```cpp
// 练习：为这个函数添加完整注释
void drawRectangle(Mat& image, 
                  Rect rect, 
                  Scalar color, 
                  int thickness = 1,
                  int lineType = LINE_8);
```

**参考答案：**
```cpp
/** @brief 在图像上绘制矩形
 * 
 * 该函数在输入图像上绘制一个矩形框。可以指定矩形的颜色、线条粗细和线型。
 * 如果厚度为负数，则表示填充矩形。
 * 
 * @param [in,out] image 输入输出图像，支持单通道或多通道图像
 * @param [in] rect 矩形区域，包含位置和大小信息
 * @param [in] color 矩形颜色，对于多通道图像使用Scalar(B,G,R)
 * @param [in] thickness 线条厚度，负数表示填充矩形（默认：1）
 * @param [in] lineType 线型，参见cv::LineTypes（默认：LINE_8）
 * 
 * @note 对于彩色图像，颜色顺序通常是BGR（蓝、绿、红）
 * @warning 确保矩形区域在图像范围内，否则可能引发越界错误
 * 
 * @see cv::rectangle 实际的绘制函数
 * @see cv::LineTypes 支持的线型枚举
 * 
 * @code{.cpp}
 * // 绘制一个红色矩形
 * Mat image = imread("test.jpg");
 * Rect roi(50, 50, 100, 100);
 * drawRectangle(image, roi, Scalar(0, 0, 255), 2);
 * @endcode
 */
```

掌握这种注释规范有助于：
1. 生成美观的API文档
2. 提高代码可读性
3. 方便IDE智能提示
4. 便于团队协作和维护